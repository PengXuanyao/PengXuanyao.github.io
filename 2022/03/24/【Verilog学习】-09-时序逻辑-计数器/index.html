<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>【Verilog学习】-09-时序逻辑-计数器 | Xuanyao's Blog</title><meta name="author" content="Xuanyao Peng"><meta name="copyright" content="Xuanyao Peng"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1 counter16 Build a 4-bit binary counter that counts from 0 through 15, inclusive, with a period of 16. The reset input is synchronous, and should reset the counter to 0. 12345678910111213module top_m">
<meta property="og:type" content="article">
<meta property="og:title" content="【Verilog学习】-09-时序逻辑-计数器">
<meta property="og:url" content="https://pengxuanyao.github.io/2022/03/24/%E3%80%90Verilog%E5%AD%A6%E4%B9%A0%E3%80%91-09-%E6%97%B6%E5%BA%8F%E9%80%BB%E8%BE%91-%E8%AE%A1%E6%95%B0%E5%99%A8/index.html">
<meta property="og:site_name" content="Xuanyao&#39;s Blog">
<meta property="og:description" content="1 counter16 Build a 4-bit binary counter that counts from 0 through 15, inclusive, with a period of 16. The reset input is synchronous, and should reset the counter to 0. 12345678910111213module top_m">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2023/01/10/K5ZwIitHl2xDTVq.jpg">
<meta property="article:published_time" content="2022-03-24T11:16:51.000Z">
<meta property="article:modified_time" content="2023-01-11T04:16:35.710Z">
<meta property="article:author" content="Xuanyao Peng">
<meta property="article:tag" content="verilog">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2023/01/10/K5ZwIitHl2xDTVq.jpg"><link rel="shortcut icon" href="https://s2.loli.net/2023/01/10/ARwIOr2ym4q5kxY.png"><link rel="canonical" href="https://pengxuanyao.github.io/2022/03/24/%E3%80%90Verilog%E5%AD%A6%E4%B9%A0%E3%80%91-09-%E6%97%B6%E5%BA%8F%E9%80%BB%E8%BE%91-%E8%AE%A1%E6%95%B0%E5%99%A8/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '【Verilog学习】-09-时序逻辑-计数器',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-01-11 12:16:35'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s2.loli.net/2023/01/11/uxgHFMtiBm1kKcf.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">104</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">71</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://api.ixiaowai.cn/gqapi/gqapi.php/')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Xuanyao's Blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">【Verilog学习】-09-时序逻辑-计数器</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-03-24T11:16:51.000Z" title="发表于 2022-03-24 19:16:51">2022-03-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-01-11T04:16:35.710Z" title="更新于 2023-01-11 12:16:35">2023-01-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="【Verilog学习】-09-时序逻辑-计数器"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="1-counter16"><a href="#1-counter16" class="headerlink" title="1 counter16"></a>1 counter16</h2><hr>
<p>Build a 4-bit binary counter that counts from 0 through 15, inclusive, with a period of 16. The reset input is synchronous, and should reset the counter to 0.</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,      <span class="comment">// Synchronous active-high reset</span></span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] q);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (reset) <span class="keyword">begin</span></span><br><span class="line">            q &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            q &lt;= q + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span>  </span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<h2 id="2-Counter10"><a href="#2-Counter10" class="headerlink" title="2 Counter10"></a>2 Counter10</h2><hr>
<p>Build a decade counter that counts from 0 through 9, inclusive, with a period of 10. The reset input is synchronous, and should reset the counter to 0.</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,        <span class="comment">// Synchronous active-high reset</span></span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] q);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (reset || q == <span class="number">4&#x27;d9</span>) <span class="keyword">begin</span></span><br><span class="line">            q &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            q &lt;= q + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<h2 id="3-Counter10-1"><a href="#3-Counter10-1" class="headerlink" title="3 Counter10-1"></a>3 Counter10-1</h2><hr>
<p>Make a decade counter that counts 1 through 10, inclusive. The reset input is synchronous, and should reset the counter to 1.</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] q);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (reset || q == <span class="number">4&#x27;d10</span>) <span class="keyword">begin</span></span><br><span class="line">            q &lt;= <span class="number">1&#x27;b1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            q &lt;= q + <span class="number">1&#x27;b1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<h2 id="4-CounterSlow"><a href="#4-CounterSlow" class="headerlink" title="4 CounterSlow"></a>4 CounterSlow</h2><hr>
<p>Build a decade counter that counts from 0 through 9, inclusive, with a period of 10. The reset input is synchronous, and should reset the counter to 0. We want to be able to pause the counter rather than always incrementing every clock cycle, so the slowena input indicates when the counter should increment.</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> slowena,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] q);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="comment">// ··· and slowena means when q == 9 and slowena == 0, the result should be keeped instead of be added.</span></span><br><span class="line">        <span class="keyword">if</span> (reset || q == <span class="number">4&#x27;d9</span> &amp;&amp; slowena == <span class="number">1</span>) <span class="keyword">begin</span></span><br><span class="line">            q &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (slowena == <span class="number">1</span>) <span class="keyword">begin</span></span><br><span class="line">            q &lt;= q + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        // here is a wiser solution as below</span></span><br><span class="line"><span class="comment">        always @(posedge clk) begin</span></span><br><span class="line"><span class="comment">            if (reset == 1&#x27;b1)</span></span><br><span class="line"><span class="comment">                q &lt;= 4&#x27;d0;</span></span><br><span class="line"><span class="comment">            else if(slowena == 1&#x27;b1) begin</span></span><br><span class="line"><span class="comment">                if (q == 4&#x27;d9)</span></span><br><span class="line"><span class="comment">                    q &lt;= 4&#x27;d0;</span></span><br><span class="line"><span class="comment">                else</span></span><br><span class="line"><span class="comment">                    q &lt;= q + 1&#x27;b1;</span></span><br><span class="line"><span class="comment">            end</span></span><br><span class="line"><span class="comment">            else</span></span><br><span class="line"><span class="comment">                q &lt;= q;  </span></span><br><span class="line"><span class="comment">        end</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<h2 id="5"><a href="#5" class="headerlink" title="5"></a>5</h2><hr>
<p>Design a 1-12 counter with the following inputs and outputs:</p>
<ul>
<li><strong>Reset</strong> Synchronous active-high reset that forces the counter to 1</li>
<li><strong>Enable</strong> Set high for the counter to run</li>
<li><strong>Clk</strong> Positive edge-triggered clock input</li>
<li><strong>Q[3:0]</strong> The output of the counter</li>
<li><strong>c_enable, c_load, c_d[3:0]</strong> Control signals going to the provided 4-bit counter, so correct operation can be verified.</li>
</ul>
<p>You have the following components available:</p>
<ul>
<li>the 4-bit binary counter (<strong>count4</strong> ) below, which has Enable and synchronous parallel-load inputs (load has higher priority than enable). The <strong>count4</strong> module is provided to you. Instantiate it in your circuit.</li>
<li>logic gates</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">module count4(</span><br><span class="line">    input clk,</span><br><span class="line">    input enable,</span><br><span class="line">    input load,</span><br><span class="line">    input [3:0] d,</span><br><span class="line">    output reg [3:0] Q</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>The <strong>c_enable</strong> , <strong>c_load</strong> , and <strong>c_d</strong> outputs are the signals that go to the internal counter’s <strong>enable</strong> , <strong>load</strong> , and <strong>d</strong> inputs, respectively. Their purpose is to allow these signals to be checked for correctness.</p>
<h3 id="Module-Declaration"><a href="#Module-Declaration" class="headerlink" title="Module Declaration"></a>Module Declaration</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">module top_module (</span><br><span class="line">    input clk,</span><br><span class="line">    input reset,</span><br><span class="line">    input enable,</span><br><span class="line">    output [3:0] Q,</span><br><span class="line">    output c_enable,</span><br><span class="line">    output c_load,</span><br><span class="line">    output [3:0] c_d</span><br><span class="line">); </span><br></pre></td></tr></table></figure>

<p>这一道题里面的c_enable,c_load,c_d开始有点迷惑，这些不应该是输入信号吗？怎么变成输出信号了？仔细一分析发现这里的c_开头的信号，应该是用作内部计数器的控制信号（也是输入信号），但是对于整个大模块来说，就不是这个输入信号了，而是内部信号，这里是相当于把内部信号印出来，作为观察和调试之用。</p>
<p>还有一个点比较迷惑的就是：</p>
<blockquote>
<p>the 4-bit binary counter (<strong>count4</strong> ) below, which has Enable and synchronous parallel-load inputs (load has higher priority than enable).</p>
</blockquote>
<p>为什么load的优先级会比enable高呢？如何设置这个优先级呢？</p>
<p>暂时的理解是：load信号是将q进行装载，不管enable是否有效，都进行装载；enable是开始计数的控制信号，只是控制q++是否进行，count4模块内部就是这样定义的，只需要使用，不需要深究。</p>
<p>代码借鉴引用2</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> enable,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] Q,</span><br><span class="line">    <span class="keyword">output</span> c_enable,</span><br><span class="line">    <span class="keyword">output</span> c_load,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] c_d</span><br><span class="line">); <span class="comment">//</span></span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        c_enable = enable;</span><br><span class="line">        c_load = (Q == <span class="number">4&#x27;d12</span> &amp; c_enable) | reset;</span><br><span class="line">        c_d = <span class="number">1&#x27;b1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    count4 the_counter (clk, c_enable, c_load, c_d, Q);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<p>这个题有点迷，有一点像74LS163的应用吧，主要这里的c_load还得受到c_enable的控制（当c_enable无效时，c_load是不能有效的，可能就是题目强调c_load的优先级高于c_enable的原因？）</p>
<h2 id="6"><a href="#6" class="headerlink" title="6"></a>6</h2><hr>
<p>From a 1000 Hz clock, derive a 1 Hz signal, called <strong>OneHertz</strong> , that could be used to drive an Enable signal for a set of hour&#x2F;minute&#x2F;second counters to create a digital wall clock. Since we want the clock to count once per second, the <strong>OneHertz</strong> signal must be asserted for exactly one cycle each second. Build the frequency divider using modulo-10 (BCD) counters and as few other gates as possible. Also output the enable signals from each of the BCD counters you use (c_enable[0] for the fastest counter, c_enable[2] for the slowest).</p>
<p>The following BCD counter is provided for you. <strong>Enable</strong> must be high for the counter to run. <strong>Reset</strong> is synchronous and set high to force the counter to zero. All counters in your circuit must directly use the same 1000 Hz signal.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">module bcdcount (</span><br><span class="line">    input clk,</span><br><span class="line">    input reset,</span><br><span class="line">    input enable,</span><br><span class="line">    output reg [3:0] Q</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="Module-Declaration-1"><a href="#Module-Declaration-1" class="headerlink" title="Module Declaration"></a>Module Declaration</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">module top_module (</span><br><span class="line">    input clk,</span><br><span class="line">    input reset,</span><br><span class="line">    output OneHertz,</span><br><span class="line">    output [2:0] c_enable</span><br><span class="line">); </span><br></pre></td></tr></table></figure>

<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>这道题卡的有点就，其实就是一个1000分频器。卡住的原因是没有弄清楚enable之间的联系，这里enable是级联三个BCD计数器进行分频的信号。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">output</span> OneHertz,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">2</span>:<span class="number">0</span>] c_enable</span><br><span class="line">); <span class="comment">//</span></span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] q1;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] q2;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] q3;</span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> ( reset ) <span class="keyword">begin</span></span><br><span class="line">            c_enable = <span class="number">4&#x27;b0</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            c_enable[<span class="number">0</span>] = <span class="number">1&#x27;b1</span>;</span><br><span class="line">            <span class="keyword">if</span> ( q1 == <span class="number">4&#x27;d9</span> ) <span class="keyword">begin</span></span><br><span class="line">                c_enable[<span class="number">1</span>] = <span class="number">1&#x27;b1</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                c_enable[<span class="number">1</span>] = <span class="number">1&#x27;b0</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">if</span> ( q1 == <span class="number">4&#x27;d9</span> &amp;&amp; q2 == <span class="number">4&#x27;d9</span> ) <span class="keyword">begin</span>    <span class="comment">// 这里需要注意一下，是在前两个都是9的时候才能置高</span></span><br><span class="line">                c_enable[<span class="number">2</span>] = <span class="number">1&#x27;b1</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                c_enable[<span class="number">2</span>] = <span class="number">1&#x27;b0</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        OneHertz = (q1 == <span class="number">4&#x27;d9</span> &amp; q2 == <span class="number">4&#x27;d9</span> &amp; q3 == <span class="number">4&#x27;d9</span>) ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    bcdcount counter0 (clk, reset, c_enable[<span class="number">0</span>], q1);</span><br><span class="line">    bcdcount counter1 (clk, reset, c_enable[<span class="number">1</span>], q2);</span><br><span class="line">    bcdcount counter2 (clk, reset, c_enable[<span class="number">2</span>], q3);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<h3 id="Module-Declaration-2"><a href="#Module-Declaration-2" class="headerlink" title="Module Declaration"></a>Module Declaration</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">module top_module (</span><br><span class="line">    input clk,</span><br><span class="line">    input reset,</span><br><span class="line">    output OneHertz,</span><br><span class="line">    output [2:0] c_enable</span><br><span class="line">); </span><br></pre></td></tr></table></figure>

<h2 id="7-CounterBCD"><a href="#7-CounterBCD" class="headerlink" title="7 CounterBCD"></a>7 CounterBCD</h2><p>Build a 4-digit BCD (binary-coded decimal) counter. Each decimal digit is encoded using 4 bits: q[3:0] is the ones digit, q[7:4] is the tens digit, etc. For digits [3:1], also output an enable signal indicating when each of the upper three digits should be incremented.</p>
<p>You may want to instantiate or modify some one-digit <a target="_blank" rel="noopener" href="https://hdlbits.01xz.net/wiki/Count10">decade counters</a>.</p>
<p><img src="https://s2.loli.net/2022/05/17/OHoDBz56UMgVuNv.png" alt="bcd-waveform"></p>
<h3 id="Module-Declaration-3"><a href="#Module-Declaration-3" class="headerlink" title="Module Declaration"></a>Module Declaration</h3><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,   <span class="comment">// Synchronous active-high reset</span></span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">1</span>] ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">15</span>:<span class="number">0</span>] q);</span><br></pre></td></tr></table></figure>

<h3 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h3><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// version - 0.0 - This version is based ont the idea on this site : https://blog.csdn.net/anbncn1234/article/details/106115746</span></span><br><span class="line"><span class="keyword">module</span> bcd_counter(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> rst,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>]  q</span><br><span class="line">);</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (rst) <span class="keyword">begin</span></span><br><span class="line">        q &lt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (ena == <span class="number">1&#x27;b1</span>) <span class="keyword">begin</span></span><br><span class="line">        <span class="comment">// back to 0</span></span><br><span class="line">        <span class="keyword">if</span> (q == <span class="number">4&#x27;d9</span>) <span class="keyword">begin</span></span><br><span class="line">            q &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="comment">// output carryflag</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( q == <span class="number">4&#x27;d8</span>) <span class="keyword">begin</span></span><br><span class="line">            q &lt;= q + <span class="number">1&#x27;b1</span>;</span><br><span class="line">        <span class="keyword">end</span> </span><br><span class="line">        <span class="comment">// +1 count</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            q &lt;= q + <span class="number">1&#x27;b1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,   <span class="comment">// Synchronous active-high reset</span></span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">1</span>] ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">15</span>:<span class="number">0</span>] q</span><br><span class="line">);</span><br><span class="line">bcd_counter bcd_counter_inst_unit(<span class="variable">.clk</span>(clk),<span class="variable">.rst</span>(reset),<span class="variable">.ena</span>(<span class="number">1&#x27;b1</span>),<span class="variable">.q</span>(q[<span class="number">3</span>:<span class="number">0</span>]));</span><br><span class="line">bcd_counter bcd_counter_inst_decade(<span class="variable">.clk</span>(clk),<span class="variable">.rst</span>(reset),<span class="variable">.ena</span>(q[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span>),<span class="variable">.q</span>(q[<span class="number">7</span>:<span class="number">4</span>]));</span><br><span class="line">bcd_counter bcd_counter_inst_hundred(<span class="variable">.clk</span>(clk),<span class="variable">.rst</span>(reset),<span class="variable">.ena</span>(q[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span> &amp; q[<span class="number">7</span>:<span class="number">4</span>] == <span class="number">4&#x27;d9</span>),<span class="variable">.q</span>(q[<span class="number">11</span>:<span class="number">8</span>]));</span><br><span class="line">bcd_counter bcd_counter_inst_thousand(<span class="variable">.clk</span>(clk),<span class="variable">.rst</span>(reset),<span class="variable">.ena</span>(q[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span> &amp; q[<span class="number">7</span>:<span class="number">4</span>] == <span class="number">4&#x27;d9</span> &amp; q[<span class="number">11</span>:<span class="number">8</span>] == <span class="number">4&#x27;d9</span>),<span class="variable">.q</span>(q[<span class="number">15</span>:<span class="number">12</span>]));</span><br><span class="line"><span class="keyword">assign</span> ena = &#123;(q[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span> &amp; q[<span class="number">7</span>:<span class="number">4</span>] == <span class="number">4&#x27;d9</span> &amp; q[<span class="number">11</span>:<span class="number">8</span>] == <span class="number">4&#x27;d9</span>),(q[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span> &amp; q[<span class="number">7</span>:<span class="number">4</span>] == <span class="number">4&#x27;d9</span>),q[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span>&#125;;</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// version - 0.1 - wrong verion bug comes from the ena_next signal, which is logical wrong. Can&#x27;t find a solution now. </span></span><br><span class="line"><span class="keyword">module</span> bcd_counter(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> rst,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>]  q,</span><br><span class="line">    <span class="keyword">output</span> ena_next</span><br><span class="line">);</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (rst) <span class="keyword">begin</span></span><br><span class="line">        q &lt;= <span class="number">0</span>;</span><br><span class="line">        ena_next &lt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (ena == <span class="number">1&#x27;b1</span>) <span class="keyword">begin</span></span><br><span class="line">        <span class="comment">// back to 0</span></span><br><span class="line">        <span class="keyword">if</span> (q == <span class="number">4&#x27;d9</span>) <span class="keyword">begin</span></span><br><span class="line">            q &lt;= <span class="number">0</span>;</span><br><span class="line">            ena_next &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="comment">// output carryflag</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( q == <span class="number">4&#x27;d8</span>) <span class="keyword">begin</span></span><br><span class="line">            ena_next &lt;= <span class="number">1&#x27;b1</span>;</span><br><span class="line">            q &lt;= q + <span class="number">1&#x27;b1</span>;</span><br><span class="line">        <span class="keyword">end</span> </span><br><span class="line">        <span class="comment">// +1 count</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            q &lt;= q + <span class="number">1&#x27;b1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,   <span class="comment">// Synchronous active-high reset</span></span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">1</span>] ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">15</span>:<span class="number">0</span>] q</span><br><span class="line">);</span><br><span class="line">bcd_counter bcd_counter_inst_unit(<span class="variable">.clk</span>(clk),<span class="variable">.rst</span>(reset),<span class="variable">.ena</span>(<span class="number">1&#x27;b1</span>),<span class="variable">.q</span>(q[<span class="number">3</span>:<span class="number">0</span>]),<span class="variable">.ena_next</span>(ena[<span class="number">1</span>]));</span><br><span class="line">bcd_counter bcd_counter_inst_decade(<span class="variable">.clk</span>(clk),<span class="variable">.rst</span>(reset),<span class="variable">.ena</span>(ena[<span class="number">1</span>]),<span class="variable">.q</span>(q[<span class="number">7</span>:<span class="number">4</span>]),<span class="variable">.ena_next</span>(ena[<span class="number">2</span>]));</span><br><span class="line">bcd_counter bcd_counter_inst_hundred(<span class="variable">.clk</span>(clk),<span class="variable">.rst</span>(reset),<span class="variable">.ena</span>(ena[<span class="number">2</span>]),<span class="variable">.q</span>(q[<span class="number">11</span>:<span class="number">8</span>]),<span class="variable">.ena_next</span>(ena[<span class="number">3</span>]));</span><br><span class="line">bcd_counter bcd_counter_inst_thousand(<span class="variable">.clk</span>(clk),<span class="variable">.rst</span>(reset),<span class="variable">.ena</span>(ena[<span class="number">3</span>]),<span class="variable">.q</span>(q[<span class="number">15</span>:<span class="number">12</span>]));</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<h3 id="Debug"><a href="#Debug" class="headerlink" title="Debug"></a>Debug</h3><ul>
<li>注意定义的时候，是 q [3:0] 还是 [3:0]q。否则可能会出现bug，<code>q has an aggregate value</code></li>
<li>这个ena信号，需要在q值为9（低位都为9）的时候，进行置高。</li>
</ul>
<h2 id="8Count-clock"><a href="#8Count-clock" class="headerlink" title="8Count clock"></a>8Count clock</h2><p>Create a set of counters suitable for use as a 12-hour clock (with am&#x2F;pm indicator). Your counters are clocked by a fast-running <code>clk</code>, with a pulse on <code>ena</code> whenever your clock should increment (i.e., once per second).</p>
<p><code>reset</code> resets the clock to 12:00 AM. <code>pm</code> is 0 for AM and 1 for PM. <code>hh</code>, <code>mm</code>, and <code>ss</code> are two <strong>BCD</strong> (Binary-Coded Decimal) digits each for hours (01-12), minutes (00-59), and seconds (00-59). Reset has higher priority than enable, and can occur even when not enabled.</p>
<p>The following timing diagram shows the rollover behaviour from <code>11:59:59 AM</code> to <code>12:00:00 PM</code> and the synchronous reset and enable behaviour.</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// version - 0.0 - wrong bcd!!!</span></span><br><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> pm,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] hh,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] mm,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] ss); </span><br><span class="line">    sec_counter sec_counter_inst(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.ena</span>(ena),<span class="variable">.ss</span>(ss));</span><br><span class="line">    min_counter min_counter_inst(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.ss</span>(ss),<span class="variable">.ena</span>(ena),<span class="variable">.mm</span>(mm));</span><br><span class="line">    hour_counter hour_counter_inst(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.ss</span>(ss),<span class="variable">.mm</span>(mm),<span class="variable">.ena</span>(ena),<span class="variable">.hh</span>(hh));</span><br><span class="line">    pm_counter pm_counter_inst(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.ss</span>(ss),<span class="variable">.mm</span>(mm),<span class="variable">.hh</span>(hh),<span class="variable">.ena</span>(ena),<span class="variable">.pm</span>(pm));</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> sec_counter(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] ss</span><br><span class="line">);</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (reset) <span class="keyword">begin</span></span><br><span class="line">        ss &lt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (ena == <span class="number">1&#x27;b1</span>) <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> (ss == <span class="number">8&#x27;d59</span>) <span class="keyword">begin</span></span><br><span class="line">                ss &lt;= <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span>    </span><br><span class="line">                ss &lt;= ss + <span class="number">1&#x27;b1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            ss &lt;= ss;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> min_counter(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> ss,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] mm</span><br><span class="line">);</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (reset) <span class="keyword">begin</span></span><br><span class="line">        mm &lt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (ena == <span class="number">1&#x27;b1</span> &amp;&amp; ss == <span class="number">8&#x27;d59</span>) <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> (mm == <span class="number">5&#x27;d59</span>) <span class="keyword">begin</span></span><br><span class="line">                mm &lt;= <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">                mm &lt;= mm + <span class="number">1&#x27;b1</span>; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            mm &lt;= mm;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> hour_counter(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> ss,</span><br><span class="line">    <span class="keyword">input</span> mm,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] hh</span><br><span class="line">);</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (reset) <span class="keyword">begin</span></span><br><span class="line">        hh &lt;= <span class="number">8&#x27;d12</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (ena == <span class="number">1&#x27;b1</span> &amp;&amp; ss == <span class="number">8&#x27;d59</span> &amp;&amp; mm == <span class="number">8&#x27;d59</span>) <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> (hh == <span class="number">8&#x27;d12</span>) <span class="keyword">begin</span></span><br><span class="line">                hh &lt;= <span class="number">1&#x27;b1</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">                hh &lt;= hh + <span class="number">1&#x27;b1</span>; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            hh &lt;= hh;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> pm_counter(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> ss,</span><br><span class="line">    <span class="keyword">input</span> mm,</span><br><span class="line">    <span class="keyword">input</span> hh,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> pm</span><br><span class="line">);</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (reset) <span class="keyword">begin</span></span><br><span class="line">        pm &lt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span>  </span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (hh == <span class="number">8&#x27;d11</span> &amp;&amp; mm == <span class="number">8&#x27;d59</span> &amp;&amp; ss == <span class="number">8&#x27;d59</span>) <span class="keyword">begin</span></span><br><span class="line">            pm &lt;= ~pm;    </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            pm &lt;= pm;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// version - 0.1 - AC</span></span><br><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> pm,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] hh,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] mm,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] ss); </span><br><span class="line">    bcd_counter bcd_counter_inst_1(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.ena</span>(ena),<span class="variable">.q</span>(ss[<span class="number">3</span>:<span class="number">0</span>]));</span><br><span class="line">    bcd_counter_mod_6 bcd_counter_mod_6_inst_1(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.ena</span>(ena &amp; (ss[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span>)),<span class="variable">.q</span>(ss[<span class="number">7</span>:<span class="number">4</span>]));</span><br><span class="line">    bcd_counter bcd_counter_inst_2(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.ena</span>(ena &amp; (ss[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span>) &amp; (ss[<span class="number">7</span>:<span class="number">4</span>] == <span class="number">4&#x27;d5</span>)),<span class="variable">.q</span>(mm[<span class="number">3</span>:<span class="number">0</span>]));</span><br><span class="line">    bcd_counter_mod_6 bcd_counter_mod_6_inst_2(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.ena</span>(ena &amp; (ss[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span>) &amp; (ss[<span class="number">7</span>:<span class="number">4</span>] == <span class="number">4&#x27;d5</span>) &amp; (mm[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span>)),<span class="variable">.q</span>(mm[<span class="number">7</span>:<span class="number">4</span>]));</span><br><span class="line">    bcd_counter_mod_12 bcd_counter_inst_3(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.ena</span>(ena &amp; (ss[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span>) &amp; (ss[<span class="number">7</span>:<span class="number">4</span>] == <span class="number">4&#x27;d5</span>) &amp; (mm[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span>) &amp; (mm[<span class="number">7</span>:<span class="number">4</span>] == <span class="number">4&#x27;d5</span>)),<span class="variable">.q</span>(hh[<span class="number">7</span>:<span class="number">0</span>]));</span><br><span class="line">    bcd_counter_pm bcd_counter_pm_inst_1(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.ena</span>(ena &amp; (ss[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span>) &amp; (ss[<span class="number">7</span>:<span class="number">4</span>] == <span class="number">4&#x27;d5</span>) &amp; (mm[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span>) &amp; (mm[<span class="number">7</span>:<span class="number">4</span>] == <span class="number">4&#x27;d5</span>) &amp; (hh[<span class="number">7</span>:<span class="number">0</span>] == <span class="number">8&#x27;h11</span>)),<span class="variable">.q</span>(pm));<span class="comment">// 这里以前有个bug：hh[7:0] == 4&#x27;h11；位宽没对上</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> bcd_counter(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] q</span><br><span class="line">);</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (reset) <span class="keyword">begin</span></span><br><span class="line">        q &lt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (ena == <span class="number">1&#x27;b1</span>) <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> (q == <span class="number">4&#x27;d9</span>) <span class="keyword">begin</span></span><br><span class="line">                q &lt;= <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                q &lt;= q + <span class="number">1&#x27;b1</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            q &lt;= q;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> bcd_counter_mod_6(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] q</span><br><span class="line">);</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (reset) <span class="keyword">begin</span></span><br><span class="line">        q &lt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (ena == <span class="number">1&#x27;b1</span>) <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> (q == <span class="number">4&#x27;d5</span>) <span class="keyword">begin</span></span><br><span class="line">                q &lt;= <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                q &lt;= q + <span class="number">1&#x27;b1</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            q &lt;= q;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> bcd_counter_mod_12(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] q</span><br><span class="line">);</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (reset) <span class="keyword">begin</span></span><br><span class="line">        q &lt;= <span class="number">8&#x27;h12</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (ena == <span class="number">1&#x27;b1</span>) <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> (q == <span class="number">8&#x27;h12</span>) <span class="keyword">begin</span></span><br><span class="line">                q &lt;= <span class="number">8&#x27;h01</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (q == <span class="number">8&#x27;h09</span>) <span class="keyword">begin</span></span><br><span class="line">                q &lt;= <span class="number">8&#x27;h10</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                q &lt;= q + <span class="number">1&#x27;b1</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            q &lt;= q;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> bcd_counter_pm(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> q</span><br><span class="line">);</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (reset) <span class="keyword">begin</span></span><br><span class="line">        q &lt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (ena == <span class="number">1&#x27;b1</span>) <span class="keyword">begin</span></span><br><span class="line">           q &lt;= ~q; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            q &lt;= q;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<h3 id="Debug-1"><a href="#Debug-1" class="headerlink" title="Debug"></a>Debug</h3><ul>
<li>例化模块时，需要在信号前面加上<code>.</code>，否则出现报错<code>cannot connect instance ports both by order and by name</code>。</li>
<li>定义模块是，结尾加<strong>分号</strong>。</li>
<li><code>truncated literal to match 4 bits File</code>；数值的位宽没有对上</li>
</ul>
<h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><p>这道题卡了很久，也算是最后独立完成了，主要要注意的点就是：</p>
<ul>
<li>位宽对上，细节问题，也是最后一个bug</li>
<li>模块复用的意识要到位</li>
<li>中间遇到的主要的问题是模12的BCD计数器的设计，这个暂时是这样写了，不知道有没有更好的办法</li>
<li>前面的思路是错误的，忘记了他是bcd计数。</li>
</ul>
<p>关于BCD计数的问题，网上看了一下，应该大多数都是这样做的，分成不同的位，进行计数。对于不是模10的倍数的BCD计数器，我这里是进行了单独的设计，网上的也是这样，只不过其是单独设计了模60和模12的计数器，我这里是设计的了模10、模6、模12的计数器。可以后面再看有没有更好的方式罢了。</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol>
<li><a target="_blank" rel="noopener" href="https://hdlbits.01xz.net/wiki/Main_Page">HDLBits (01xz.net)</a></li>
<li><a target="_blank" rel="noopener" href="https://bbs.huaweicloud.com/blogs/detail/283302">HDLBits 系列（16）Something about Counter-云社区-华为云 (huaweicloud.com)</a></li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://pengxuanyao.github.io">Xuanyao Peng</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://pengxuanyao.github.io/2022/03/24/%E3%80%90Verilog%E5%AD%A6%E4%B9%A0%E3%80%91-09-%E6%97%B6%E5%BA%8F%E9%80%BB%E8%BE%91-%E8%AE%A1%E6%95%B0%E5%99%A8/">https://pengxuanyao.github.io/2022/03/24/%E3%80%90Verilog%E5%AD%A6%E4%B9%A0%E3%80%91-09-%E6%97%B6%E5%BA%8F%E9%80%BB%E8%BE%91-%E8%AE%A1%E6%95%B0%E5%99%A8/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://pengxuanyao.github.io" target="_blank">Xuanyao's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/verilog/">verilog</a></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2023/01/10/K5ZwIitHl2xDTVq.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/03/24/%E3%80%90%E5%A4%A7%E5%88%9B%E3%80%91-00-BH1750/"><img class="prev-cover" src="https://s2.loli.net/2023/01/10/SXzEbODUZN6aTRt.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">【大创】-00-BH1750</div></div></a></div><div class="next-post pull-right"><a href="/2022/03/22/%E3%80%90CNC3018%E3%80%91-00-GetStarted/"><img class="next-cover" src="https://s2.loli.net/2023/01/10/7U3jcBtNrnDlIou.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">【CNC3018】-00-GetStarted</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/01/12/%E3%80%90CAG_SLAM%E3%80%91-01-%E6%8E%A7%E5%88%B6%E4%BF%A1%E5%8F%B7/" title="【CAG_SLAM】-01-控制信号"><img class="cover" src="https://s2.loli.net/2023/01/10/MhktI1loSdFYmJT.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-12</div><div class="title">【CAG_SLAM】-01-控制信号</div></div></a></div><div><a href="/2022/01/05/%E3%80%90CAG_SLAM%E3%80%91-00-%E6%AF%94%E8%BE%83%E6%A0%91/" title="【CAG_SLAM】-00-比较树"><img class="cover" src="https://s2.loli.net/2023/01/10/MhktI1loSdFYmJT.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-05</div><div class="title">【CAG_SLAM】-00-比较树</div></div></a></div><div><a href="/2022/01/17/%E3%80%90CAG_SLAM%E3%80%91-02-%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/" title="【CAG-SLAM】-02-项目总结"><img class="cover" src="https://s2.loli.net/2023/01/10/MhktI1loSdFYmJT.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-17</div><div class="title">【CAG-SLAM】-02-项目总结</div></div></a></div><div><a href="/2022/02/28/%E3%80%90CAG_SLAM%E3%80%91-03-Padding-Modules/" title="【CAG_SLAM】-03-Padding-Modules"><img class="cover" src="https://s2.loli.net/2023/01/10/MhktI1loSdFYmJT.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-28</div><div class="title">【CAG_SLAM】-03-Padding-Modules</div></div></a></div><div><a href="/2022/03/17/%E3%80%90CAG_SLAM%E3%80%91-04-%E9%99%A4%E6%B3%95%E5%99%A8/" title="【CAG_SLAM】-04-除法器"><img class="cover" src="https://s2.loli.net/2023/01/10/MhktI1loSdFYmJT.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-17</div><div class="title">【CAG_SLAM】-04-除法器</div></div></a></div><div><a href="/2022/03/20/%E3%80%90CAG_SLAM%E3%80%91-05-Zero-Padding/" title="【CAG_SLAM】-05-Zero-Padding"><img class="cover" src="https://s2.loli.net/2023/01/10/MhktI1loSdFYmJT.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-20</div><div class="title">【CAG_SLAM】-05-Zero-Padding</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s2.loli.net/2023/01/11/uxgHFMtiBm1kKcf.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Xuanyao Peng</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">104</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">71</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/PengXuanyao"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">新手学电脑，也请多多指教。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-counter16"><span class="toc-number">1.</span> <span class="toc-text">1 counter16</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Counter10"><span class="toc-number">2.</span> <span class="toc-text">2 Counter10</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Counter10-1"><span class="toc-number">3.</span> <span class="toc-text">3 Counter10-1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-CounterSlow"><span class="toc-number">4.</span> <span class="toc-text">4 CounterSlow</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5"><span class="toc-number">5.</span> <span class="toc-text">5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Module-Declaration"><span class="toc-number">5.1.</span> <span class="toc-text">Module Declaration</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6"><span class="toc-number">6.</span> <span class="toc-text">6</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Module-Declaration-1"><span class="toc-number">6.1.</span> <span class="toc-text">Module Declaration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution"><span class="toc-number">6.2.</span> <span class="toc-text">Solution</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Module-Declaration-2"><span class="toc-number">6.3.</span> <span class="toc-text">Module Declaration</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-CounterBCD"><span class="toc-number">7.</span> <span class="toc-text">7 CounterBCD</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Module-Declaration-3"><span class="toc-number">7.1.</span> <span class="toc-text">Module Declaration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#solution"><span class="toc-number">7.2.</span> <span class="toc-text">solution</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Debug"><span class="toc-number">7.3.</span> <span class="toc-text">Debug</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8Count-clock"><span class="toc-number">8.</span> <span class="toc-text">8Count clock</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Debug-1"><span class="toc-number">8.1.</span> <span class="toc-text">Debug</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Summary"><span class="toc-number">8.2.</span> <span class="toc-text">Summary</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">9.</span> <span class="toc-text">Reference</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/01/12/%E3%80%90Hexo%E3%80%91-06-%E4%BD%BF%E7%94%A8github%E5%90%8C%E6%AD%A5%E5%8D%9A%E5%AE%A2%E6%97%B6%E7%9A%84%E8%8B%A5%E5%B9%B2%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3/" title="【Hexo】-06-使用github同步博客时的若干问题及解决"><img src="https://s2.loli.net/2023/01/10/Gnz3RKpxZOYeulf.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【Hexo】-06-使用github同步博客时的若干问题及解决"/></a><div class="content"><a class="title" href="/2023/01/12/%E3%80%90Hexo%E3%80%91-06-%E4%BD%BF%E7%94%A8github%E5%90%8C%E6%AD%A5%E5%8D%9A%E5%AE%A2%E6%97%B6%E7%9A%84%E8%8B%A5%E5%B9%B2%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3/" title="【Hexo】-06-使用github同步博客时的若干问题及解决">【Hexo】-06-使用github同步博客时的若干问题及解决</a><time datetime="2023-01-12T09:56:23.000Z" title="发表于 2023-01-12 17:56:23">2023-01-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/10/%E3%80%90Fluid%E3%80%9100_Hexo%E4%B8%BB%E9%A2%98Fluid%E9%85%8D%E7%BD%AE/" title="【Fluid】00_Hexo主题Fluid配置"><img src="https://avatars2.githubusercontent.com/t/3419353?s=280&amp;v=4" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【Fluid】00_Hexo主题Fluid配置"/></a><div class="content"><a class="title" href="/2023/01/10/%E3%80%90Fluid%E3%80%9100_Hexo%E4%B8%BB%E9%A2%98Fluid%E9%85%8D%E7%BD%AE/" title="【Fluid】00_Hexo主题Fluid配置">【Fluid】00_Hexo主题Fluid配置</a><time datetime="2023-01-10T07:10:00.000Z" title="发表于 2023-01-10 15:10:00">2023-01-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/18/%E3%80%90ChiselBookByLiang%E3%80%9100_Chisel/" title="【ChiselBookByLiang】00_Chisel"><img src="https://s2.loli.net/2023/01/10/WrvaUEYJ4xioHbm.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【ChiselBookByLiang】00_Chisel"/></a><div class="content"><a class="title" href="/2022/12/18/%E3%80%90ChiselBookByLiang%E3%80%9100_Chisel/" title="【ChiselBookByLiang】00_Chisel">【ChiselBookByLiang】00_Chisel</a><time datetime="2022-12-18T03:36:20.000Z" title="发表于 2022-12-18 11:36:20">2022-12-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/10/%E3%80%90ChiselBookV1%E3%80%9100_Combinational_Circuit/" title="【ChiselBookV1】00_Combinational_Circuit"><img src="https://s2.loli.net/2023/01/10/w6JK7dIO8ijpDg3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【ChiselBookV1】00_Combinational_Circuit"/></a><div class="content"><a class="title" href="/2022/12/10/%E3%80%90ChiselBookV1%E3%80%9100_Combinational_Circuit/" title="【ChiselBookV1】00_Combinational_Circuit">【ChiselBookV1】00_Combinational_Circuit</a><time datetime="2022-12-10T11:20:20.000Z" title="发表于 2022-12-10 19:20:20">2022-12-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/01/%E3%80%90pa%E3%80%9100_pa_0_record/" title="【PA】00_pa0_record"><img src="https://s2.loli.net/2023/01/10/xcguCKnW8l9adLR.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【PA】00_pa0_record"/></a><div class="content"><a class="title" href="/2022/12/01/%E3%80%90pa%E3%80%9100_pa_0_record/" title="【PA】00_pa0_record">【PA】00_pa0_record</a><time datetime="2022-12-01T08:29:24.000Z" title="发表于 2022-12-01 16:29:24">2022-12-01</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Xuanyao Peng</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">❤️🧡💚🇨🇳💙💜🤎</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>