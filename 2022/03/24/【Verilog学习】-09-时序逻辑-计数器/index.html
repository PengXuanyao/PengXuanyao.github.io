<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.9.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>
<meta name="description" content="1 counter16  Build a 4-bit binary counter that counts from 0 through 15, inclusive, with a period of 16. The reset input is synchronous, and should reset the counter to 0. 12345678910111213module">
<meta property="og:type" content="article">
<meta property="og:title" content="【Verilog学习】-09-时序逻辑-计数器">
<meta property="og:url" content="http://example.com/2022/03/24/%E3%80%90Verilog%E5%AD%A6%E4%B9%A0%E3%80%91-09-%E6%97%B6%E5%BA%8F%E9%80%BB%E8%BE%91-%E8%AE%A1%E6%95%B0%E5%99%A8/index.html">
<meta property="og:site_name" content="PengXuanyao">
<meta property="og:description" content="1 counter16  Build a 4-bit binary counter that counts from 0 through 15, inclusive, with a period of 16. The reset input is synchronous, and should reset the counter to 0. 12345678910111213module">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2022/05/17/OHoDBz56UMgVuNv.png">
<meta property="article:published_time" content="2022-03-24T11:16:51.000Z">
<meta property="article:modified_time" content="2022-07-15T13:55:46.060Z">
<meta property="article:author" content="PengXuanyao">
<meta property="article:tag" content="verilog">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2022/05/17/OHoDBz56UMgVuNv.png">


<link rel="canonical" href="http://example.com/2022/03/24/%E3%80%90Verilog%E5%AD%A6%E4%B9%A0%E3%80%91-09-%E6%97%B6%E5%BA%8F%E9%80%BB%E8%BE%91-%E8%AE%A1%E6%95%B0%E5%99%A8/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2022/03/24/%E3%80%90Verilog%E5%AD%A6%E4%B9%A0%E3%80%91-09-%E6%97%B6%E5%BA%8F%E9%80%BB%E8%BE%91-%E8%AE%A1%E6%95%B0%E5%99%A8/","path":"2022/03/24/【Verilog学习】-09-时序逻辑-计数器/","title":"【Verilog学习】-09-时序逻辑-计数器"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>【Verilog学习】-09-时序逻辑-计数器 | PengXuanyao</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">PengXuanyao</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">天地交，万物通</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#counter16"><span class="nav-number">1.</span> <span class="nav-text">1 counter16</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#counter10"><span class="nav-number">2.</span> <span class="nav-text">2 Counter10</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#counter10-1"><span class="nav-number">3.</span> <span class="nav-text">3 Counter10-1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#counterslow"><span class="nav-number">4.</span> <span class="nav-text">4 CounterSlow</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#section"><span class="nav-number">5.</span> <span class="nav-text">5</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#module-declaration"><span class="nav-number">5.1.</span> <span class="nav-text">Module Declaration</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#section-1"><span class="nav-number">6.</span> <span class="nav-text">6</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#module-declaration-1"><span class="nav-number">6.1.</span> <span class="nav-text">Module Declaration</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#solution"><span class="nav-number">6.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#module-declaration-2"><span class="nav-number">6.3.</span> <span class="nav-text">Module Declaration</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#counterbcd"><span class="nav-number">7.</span> <span class="nav-text">7 CounterBCD</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#module-declaration-3"><span class="nav-number">7.1.</span> <span class="nav-text">Module Declaration</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#solution-1"><span class="nav-number">7.2.</span> <span class="nav-text">solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#debug"><span class="nav-number">7.3.</span> <span class="nav-text">Debug</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#count-clock"><span class="nav-number">8.</span> <span class="nav-text">8Count clock</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#debug-1"><span class="nav-number">8.1.</span> <span class="nav-text">Debug</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#summary"><span class="nav-number">8.2.</span> <span class="nav-text">Summary</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#reference"><span class="nav-number">9.</span> <span class="nav-text">Reference</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="PengXuanyao"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">PengXuanyao</p>
  <div class="site-description" itemprop="description">This is my personal blog</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">82</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/03/24/%E3%80%90Verilog%E5%AD%A6%E4%B9%A0%E3%80%91-09-%E6%97%B6%E5%BA%8F%E9%80%BB%E8%BE%91-%E8%AE%A1%E6%95%B0%E5%99%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="PengXuanyao">
      <meta itemprop="description" content="This is my personal blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="PengXuanyao">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          【Verilog学习】-09-时序逻辑-计数器
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-03-24 19:16:51" itemprop="dateCreated datePublished" datetime="2022-03-24T19:16:51+08:00">2022-03-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-07-15 21:55:46" itemprop="dateModified" datetime="2022-07-15T21:55:46+08:00">2022-07-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">学习</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h2 id="counter16">1 counter16</h2>
<hr />
<p>Build a 4-bit binary counter that counts from 0 through 15,
inclusive, with a period of 16. The reset input is synchronous, and
should reset the counter to 0.</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,      <span class="comment">// Synchronous active-high reset</span></span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] q);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (reset) <span class="keyword">begin</span></span><br><span class="line">            q &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            q &lt;= q + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span>  </span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<h2 id="counter10">2 Counter10</h2>
<hr />
<p>Build a decade counter that counts from 0 through 9, inclusive, with
a period of 10. The reset input is synchronous, and should reset the
counter to 0.</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,        <span class="comment">// Synchronous active-high reset</span></span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] q);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (reset || q == <span class="number">4&#x27;d9</span>) <span class="keyword">begin</span></span><br><span class="line">            q &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            q &lt;= q + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<h2 id="counter10-1">3 Counter10-1</h2>
<hr />
<p>Make a decade counter that counts 1 through 10, inclusive. The reset
input is synchronous, and should reset the counter to 1.</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] q);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (reset || q == <span class="number">4&#x27;d10</span>) <span class="keyword">begin</span></span><br><span class="line">            q &lt;= <span class="number">1&#x27;b1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            q &lt;= q + <span class="number">1&#x27;b1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<h2 id="counterslow">4 CounterSlow</h2>
<hr />
<p>Build a decade counter that counts from 0 through 9, inclusive, with
a period of 10. The reset input is synchronous, and should reset the
counter to 0. We want to be able to pause the counter rather than always
incrementing every clock cycle, so the slowena input indicates when the
counter should increment.</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> slowena,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] q);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="comment">// ··· and slowena means when q == 9 and slowena == 0, the result should be keeped instead of be added.</span></span><br><span class="line">        <span class="keyword">if</span> (reset || q == <span class="number">4&#x27;d9</span> &amp;&amp; slowena == <span class="number">1</span>) <span class="keyword">begin</span></span><br><span class="line">            q &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (slowena == <span class="number">1</span>) <span class="keyword">begin</span></span><br><span class="line">            q &lt;= q + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        // here is a wiser solution as below</span></span><br><span class="line"><span class="comment">        always @(posedge clk) begin</span></span><br><span class="line"><span class="comment">            if (reset == 1&#x27;b1)</span></span><br><span class="line"><span class="comment">                q &lt;= 4&#x27;d0;</span></span><br><span class="line"><span class="comment">            else if(slowena == 1&#x27;b1) begin</span></span><br><span class="line"><span class="comment">                if (q == 4&#x27;d9)</span></span><br><span class="line"><span class="comment">                    q &lt;= 4&#x27;d0;</span></span><br><span class="line"><span class="comment">                else</span></span><br><span class="line"><span class="comment">                    q &lt;= q + 1&#x27;b1;</span></span><br><span class="line"><span class="comment">            end</span></span><br><span class="line"><span class="comment">            else</span></span><br><span class="line"><span class="comment">                q &lt;= q;  </span></span><br><span class="line"><span class="comment">        end</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<h2 id="section">5</h2>
<hr />
<p>Design a 1-12 counter with the following inputs and outputs:</p>
<ul>
<li><strong>Reset</strong> Synchronous active-high reset that forces the
counter to 1</li>
<li><strong>Enable</strong> Set high for the counter to run</li>
<li><strong>Clk</strong> Positive edge-triggered clock input</li>
<li><strong>Q[3:0]</strong> The output of the counter</li>
<li><strong>c_enable, c_load, c_d[3:0]</strong> Control signals going to
the provided 4-bit counter, so correct operation can be verified.</li>
</ul>
<p>You have the following components available:</p>
<ul>
<li>the 4-bit binary counter (<strong>count4</strong> ) below, which has
Enable and synchronous parallel-load inputs (load has higher priority
than enable). The <strong>count4</strong> module is provided to you.
Instantiate it in your circuit.</li>
<li>logic gates</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">module count4(</span><br><span class="line">    input clk,</span><br><span class="line">    input enable,</span><br><span class="line">    input load,</span><br><span class="line">    input [3:0] d,</span><br><span class="line">    output reg [3:0] Q</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>The <strong>c_enable</strong> , <strong>c_load</strong> , and
<strong>c_d</strong> outputs are the signals that go to the internal
counter's <strong>enable</strong> , <strong>load</strong> , and
<strong>d</strong> inputs, respectively. Their purpose is to allow these
signals to be checked for correctness.</p>
<h3 id="module-declaration">Module Declaration</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">module top_module (</span><br><span class="line">    input clk,</span><br><span class="line">    input reset,</span><br><span class="line">    input enable,</span><br><span class="line">    output [3:0] Q,</span><br><span class="line">    output c_enable,</span><br><span class="line">    output c_load,</span><br><span class="line">    output [3:0] c_d</span><br><span class="line">); </span><br></pre></td></tr></table></figure>
<p>这一道题里面的c_enable,c_load,c_d开始有点迷惑，这些不应该是输入信号吗？怎么变成输出信号了？仔细一分析发现这里的c_开头的信号，应该是用作内部计数器的控制信号（也是输入信号），但是对于整个大模块来说，就不是这个输入信号了，而是内部信号，这里是相当于把内部信号印出来，作为观察和调试之用。</p>
<p>还有一个点比较迷惑的就是：</p>
<blockquote>
<p>the 4-bit binary counter (<strong>count4</strong> ) below, which has
Enable and synchronous parallel-load inputs (load has higher priority
than enable).</p>
</blockquote>
<p>为什么load的优先级会比enable高呢？如何设置这个优先级呢？</p>
<p>暂时的理解是：load信号是将q进行装载，不管enable是否有效，都进行装载；enable是开始计数的控制信号，只是控制q++是否进行，count4模块内部就是这样定义的，只需要使用，不需要深究。</p>
<p>代码借鉴引用2</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> enable,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] Q,</span><br><span class="line">    <span class="keyword">output</span> c_enable,</span><br><span class="line">    <span class="keyword">output</span> c_load,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] c_d</span><br><span class="line">); <span class="comment">//</span></span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        c_enable = enable;</span><br><span class="line">        c_load = (Q == <span class="number">4&#x27;d12</span> &amp; c_enable) | reset;</span><br><span class="line">        c_d = <span class="number">1&#x27;b1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    count4 the_counter (clk, c_enable, c_load, c_d, Q);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>这个题有点迷，有一点像74LS163的应用吧，主要这里的c_load还得受到c_enable的控制（当c_enable无效时，c_load是不能有效的，可能就是题目强调c_load的优先级高于c_enable的原因？）</p>
<h2 id="section-1">6</h2>
<hr />
<p>From a 1000 Hz clock, derive a 1 Hz signal, called
<strong>OneHertz</strong> , that could be used to drive an Enable signal
for a set of hour/minute/second counters to create a digital wall clock.
Since we want the clock to count once per second, the
<strong>OneHertz</strong> signal must be asserted for exactly one cycle
each second. Build the frequency divider using modulo-10 (BCD) counters
and as few other gates as possible. Also output the enable signals from
each of the BCD counters you use (c_enable[0] for the fastest counter,
c_enable[2] for the slowest).</p>
<p>The following BCD counter is provided for you.
<strong>Enable</strong> must be high for the counter to run.
<strong>Reset</strong> is synchronous and set high to force the counter
to zero. All counters in your circuit must directly use the same 1000 Hz
signal.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">module bcdcount (</span><br><span class="line">    input clk,</span><br><span class="line">    input reset,</span><br><span class="line">    input enable,</span><br><span class="line">    output reg [3:0] Q</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="module-declaration-1">Module Declaration</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">module top_module (</span><br><span class="line">    input clk,</span><br><span class="line">    input reset,</span><br><span class="line">    output OneHertz,</span><br><span class="line">    output [2:0] c_enable</span><br><span class="line">); </span><br></pre></td></tr></table></figure>
<h3 id="solution">Solution</h3>
<p>这道题卡的有点就，其实就是一个1000分频器。卡住的原因是没有弄清楚enable之间的联系，这里enable是级联三个BCD计数器进行分频的信号。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">output</span> OneHertz,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">2</span>:<span class="number">0</span>] c_enable</span><br><span class="line">); <span class="comment">//</span></span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] q1;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] q2;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] q3;</span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> ( reset ) <span class="keyword">begin</span></span><br><span class="line">            c_enable = <span class="number">4&#x27;b0</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            c_enable[<span class="number">0</span>] = <span class="number">1&#x27;b1</span>;</span><br><span class="line">            <span class="keyword">if</span> ( q1 == <span class="number">4&#x27;d9</span> ) <span class="keyword">begin</span></span><br><span class="line">                c_enable[<span class="number">1</span>] = <span class="number">1&#x27;b1</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                c_enable[<span class="number">1</span>] = <span class="number">1&#x27;b0</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">if</span> ( q1 == <span class="number">4&#x27;d9</span> &amp;&amp; q2 == <span class="number">4&#x27;d9</span> ) <span class="keyword">begin</span>    <span class="comment">// 这里需要注意一下，是在前两个都是9的时候才能置高</span></span><br><span class="line">                c_enable[<span class="number">2</span>] = <span class="number">1&#x27;b1</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                c_enable[<span class="number">2</span>] = <span class="number">1&#x27;b0</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        OneHertz = (q1 == <span class="number">4&#x27;d9</span> &amp; q2 == <span class="number">4&#x27;d9</span> &amp; q3 == <span class="number">4&#x27;d9</span>) ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    bcdcount counter0 (clk, reset, c_enable[<span class="number">0</span>], q1);</span><br><span class="line">    bcdcount counter1 (clk, reset, c_enable[<span class="number">1</span>], q2);</span><br><span class="line">    bcdcount counter2 (clk, reset, c_enable[<span class="number">2</span>], q3);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<h3 id="module-declaration-2">Module Declaration</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">module top_module (</span><br><span class="line">    input clk,</span><br><span class="line">    input reset,</span><br><span class="line">    output OneHertz,</span><br><span class="line">    output [2:0] c_enable</span><br><span class="line">); </span><br></pre></td></tr></table></figure>
<h2 id="counterbcd">7 CounterBCD</h2>
<p>Build a 4-digit BCD (binary-coded decimal) counter. Each decimal
digit is encoded using 4 bits: q[3:0] is the ones digit, q[7:4] is the
tens digit, etc. For digits [3:1], also output an enable signal
indicating when each of the upper three digits should be
incremented.</p>
<p>You may want to instantiate or modify some one-digit <a
target="_blank" rel="noopener" href="https://hdlbits.01xz.net/wiki/Count10">decade counters</a>.</p>
<figure>
<img src="https://s2.loli.net/2022/05/17/OHoDBz56UMgVuNv.png"
alt="bcd-waveform" />
<figcaption aria-hidden="true">bcd-waveform</figcaption>
</figure>
<h3 id="module-declaration-3">Module Declaration</h3>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,   <span class="comment">// Synchronous active-high reset</span></span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">1</span>] ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">15</span>:<span class="number">0</span>] q);</span><br></pre></td></tr></table></figure>
<h3 id="solution-1">solution</h3>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// version - 0.0 - This version is based ont the idea on this site : https://blog.csdn.net/anbncn1234/article/details/106115746</span></span><br><span class="line"><span class="keyword">module</span> bcd_counter(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> rst,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>]  q</span><br><span class="line">);</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (rst) <span class="keyword">begin</span></span><br><span class="line">        q &lt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (ena == <span class="number">1&#x27;b1</span>) <span class="keyword">begin</span></span><br><span class="line">        <span class="comment">// back to 0</span></span><br><span class="line">        <span class="keyword">if</span> (q == <span class="number">4&#x27;d9</span>) <span class="keyword">begin</span></span><br><span class="line">            q &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="comment">// output carryflag</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( q == <span class="number">4&#x27;d8</span>) <span class="keyword">begin</span></span><br><span class="line">            q &lt;= q + <span class="number">1&#x27;b1</span>;</span><br><span class="line">        <span class="keyword">end</span> </span><br><span class="line">        <span class="comment">// +1 count</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            q &lt;= q + <span class="number">1&#x27;b1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,   <span class="comment">// Synchronous active-high reset</span></span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">1</span>] ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">15</span>:<span class="number">0</span>] q</span><br><span class="line">);</span><br><span class="line">bcd_counter bcd_counter_inst_unit(<span class="variable">.clk</span>(clk),<span class="variable">.rst</span>(reset),<span class="variable">.ena</span>(<span class="number">1&#x27;b1</span>),<span class="variable">.q</span>(q[<span class="number">3</span>:<span class="number">0</span>]));</span><br><span class="line">bcd_counter bcd_counter_inst_decade(<span class="variable">.clk</span>(clk),<span class="variable">.rst</span>(reset),<span class="variable">.ena</span>(q[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span>),<span class="variable">.q</span>(q[<span class="number">7</span>:<span class="number">4</span>]));</span><br><span class="line">bcd_counter bcd_counter_inst_hundred(<span class="variable">.clk</span>(clk),<span class="variable">.rst</span>(reset),<span class="variable">.ena</span>(q[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span> &amp; q[<span class="number">7</span>:<span class="number">4</span>] == <span class="number">4&#x27;d9</span>),<span class="variable">.q</span>(q[<span class="number">11</span>:<span class="number">8</span>]));</span><br><span class="line">bcd_counter bcd_counter_inst_thousand(<span class="variable">.clk</span>(clk),<span class="variable">.rst</span>(reset),<span class="variable">.ena</span>(q[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span> &amp; q[<span class="number">7</span>:<span class="number">4</span>] == <span class="number">4&#x27;d9</span> &amp; q[<span class="number">11</span>:<span class="number">8</span>] == <span class="number">4&#x27;d9</span>),<span class="variable">.q</span>(q[<span class="number">15</span>:<span class="number">12</span>]));</span><br><span class="line"><span class="keyword">assign</span> ena = &#123;(q[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span> &amp; q[<span class="number">7</span>:<span class="number">4</span>] == <span class="number">4&#x27;d9</span> &amp; q[<span class="number">11</span>:<span class="number">8</span>] == <span class="number">4&#x27;d9</span>),(q[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span> &amp; q[<span class="number">7</span>:<span class="number">4</span>] == <span class="number">4&#x27;d9</span>),q[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span>&#125;;</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// version - 0.1 - wrong verion bug comes from the ena_next signal, which is logical wrong. Can&#x27;t find a solution now. </span></span><br><span class="line"><span class="keyword">module</span> bcd_counter(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> rst,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>]  q,</span><br><span class="line">    <span class="keyword">output</span> ena_next</span><br><span class="line">);</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (rst) <span class="keyword">begin</span></span><br><span class="line">        q &lt;= <span class="number">0</span>;</span><br><span class="line">        ena_next &lt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (ena == <span class="number">1&#x27;b1</span>) <span class="keyword">begin</span></span><br><span class="line">        <span class="comment">// back to 0</span></span><br><span class="line">        <span class="keyword">if</span> (q == <span class="number">4&#x27;d9</span>) <span class="keyword">begin</span></span><br><span class="line">            q &lt;= <span class="number">0</span>;</span><br><span class="line">            ena_next &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="comment">// output carryflag</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( q == <span class="number">4&#x27;d8</span>) <span class="keyword">begin</span></span><br><span class="line">            ena_next &lt;= <span class="number">1&#x27;b1</span>;</span><br><span class="line">            q &lt;= q + <span class="number">1&#x27;b1</span>;</span><br><span class="line">        <span class="keyword">end</span> </span><br><span class="line">        <span class="comment">// +1 count</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            q &lt;= q + <span class="number">1&#x27;b1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,   <span class="comment">// Synchronous active-high reset</span></span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">1</span>] ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">15</span>:<span class="number">0</span>] q</span><br><span class="line">);</span><br><span class="line">bcd_counter bcd_counter_inst_unit(<span class="variable">.clk</span>(clk),<span class="variable">.rst</span>(reset),<span class="variable">.ena</span>(<span class="number">1&#x27;b1</span>),<span class="variable">.q</span>(q[<span class="number">3</span>:<span class="number">0</span>]),<span class="variable">.ena_next</span>(ena[<span class="number">1</span>]));</span><br><span class="line">bcd_counter bcd_counter_inst_decade(<span class="variable">.clk</span>(clk),<span class="variable">.rst</span>(reset),<span class="variable">.ena</span>(ena[<span class="number">1</span>]),<span class="variable">.q</span>(q[<span class="number">7</span>:<span class="number">4</span>]),<span class="variable">.ena_next</span>(ena[<span class="number">2</span>]));</span><br><span class="line">bcd_counter bcd_counter_inst_hundred(<span class="variable">.clk</span>(clk),<span class="variable">.rst</span>(reset),<span class="variable">.ena</span>(ena[<span class="number">2</span>]),<span class="variable">.q</span>(q[<span class="number">11</span>:<span class="number">8</span>]),<span class="variable">.ena_next</span>(ena[<span class="number">3</span>]));</span><br><span class="line">bcd_counter bcd_counter_inst_thousand(<span class="variable">.clk</span>(clk),<span class="variable">.rst</span>(reset),<span class="variable">.ena</span>(ena[<span class="number">3</span>]),<span class="variable">.q</span>(q[<span class="number">15</span>:<span class="number">12</span>]));</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<h3 id="debug">Debug</h3>
<ul>
<li>注意定义的时候，是 q [3:0] 还是
[3:0]q。否则可能会出现bug，<code>q has an aggregate value</code></li>
<li>这个ena信号，需要在q值为9（低位都为9）的时候，进行置高。</li>
</ul>
<h2 id="count-clock">8Count clock</h2>
<p>Create a set of counters suitable for use as a 12-hour clock (with
am/pm indicator). Your counters are clocked by a fast-running
<code>clk</code>, with a pulse on <code>ena</code> whenever your clock
should increment (i.e., once per second).</p>
<p><code>reset</code> resets the clock to 12:00 AM. <code>pm</code> is 0
for AM and 1 for PM. <code>hh</code>, <code>mm</code>, and
<code>ss</code> are two <strong>BCD</strong> (Binary-Coded Decimal)
digits each for hours (01-12), minutes (00-59), and seconds (00-59).
Reset has higher priority than enable, and can occur even when not
enabled.</p>
<p>The following timing diagram shows the rollover behaviour from
<code>11:59:59 AM</code> to <code>12:00:00 PM</code> and the synchronous
reset and enable behaviour.</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// version - 0.0 - wrong bcd!!!</span></span><br><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> pm,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] hh,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] mm,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] ss); </span><br><span class="line">    sec_counter sec_counter_inst(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.ena</span>(ena),<span class="variable">.ss</span>(ss));</span><br><span class="line">    min_counter min_counter_inst(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.ss</span>(ss),<span class="variable">.ena</span>(ena),<span class="variable">.mm</span>(mm));</span><br><span class="line">    hour_counter hour_counter_inst(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.ss</span>(ss),<span class="variable">.mm</span>(mm),<span class="variable">.ena</span>(ena),<span class="variable">.hh</span>(hh));</span><br><span class="line">    pm_counter pm_counter_inst(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.ss</span>(ss),<span class="variable">.mm</span>(mm),<span class="variable">.hh</span>(hh),<span class="variable">.ena</span>(ena),<span class="variable">.pm</span>(pm));</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> sec_counter(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] ss</span><br><span class="line">);</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (reset) <span class="keyword">begin</span></span><br><span class="line">        ss &lt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (ena == <span class="number">1&#x27;b1</span>) <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> (ss == <span class="number">8&#x27;d59</span>) <span class="keyword">begin</span></span><br><span class="line">                ss &lt;= <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span>    </span><br><span class="line">                ss &lt;= ss + <span class="number">1&#x27;b1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            ss &lt;= ss;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> min_counter(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> ss,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] mm</span><br><span class="line">);</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (reset) <span class="keyword">begin</span></span><br><span class="line">        mm &lt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (ena == <span class="number">1&#x27;b1</span> &amp;&amp; ss == <span class="number">8&#x27;d59</span>) <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> (mm == <span class="number">5&#x27;d59</span>) <span class="keyword">begin</span></span><br><span class="line">                mm &lt;= <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">                mm &lt;= mm + <span class="number">1&#x27;b1</span>; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            mm &lt;= mm;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> hour_counter(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> ss,</span><br><span class="line">    <span class="keyword">input</span> mm,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] hh</span><br><span class="line">);</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (reset) <span class="keyword">begin</span></span><br><span class="line">        hh &lt;= <span class="number">8&#x27;d12</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (ena == <span class="number">1&#x27;b1</span> &amp;&amp; ss == <span class="number">8&#x27;d59</span> &amp;&amp; mm == <span class="number">8&#x27;d59</span>) <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> (hh == <span class="number">8&#x27;d12</span>) <span class="keyword">begin</span></span><br><span class="line">                hh &lt;= <span class="number">1&#x27;b1</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">                hh &lt;= hh + <span class="number">1&#x27;b1</span>; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            hh &lt;= hh;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> pm_counter(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> ss,</span><br><span class="line">    <span class="keyword">input</span> mm,</span><br><span class="line">    <span class="keyword">input</span> hh,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> pm</span><br><span class="line">);</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (reset) <span class="keyword">begin</span></span><br><span class="line">        pm &lt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span>  </span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (hh == <span class="number">8&#x27;d11</span> &amp;&amp; mm == <span class="number">8&#x27;d59</span> &amp;&amp; ss == <span class="number">8&#x27;d59</span>) <span class="keyword">begin</span></span><br><span class="line">            pm &lt;= ~pm;    </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            pm &lt;= pm;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// version - 0.1 - AC</span></span><br><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> pm,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] hh,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] mm,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] ss); </span><br><span class="line">    bcd_counter bcd_counter_inst_1(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.ena</span>(ena),<span class="variable">.q</span>(ss[<span class="number">3</span>:<span class="number">0</span>]));</span><br><span class="line">    bcd_counter_mod_6 bcd_counter_mod_6_inst_1(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.ena</span>(ena &amp; (ss[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span>)),<span class="variable">.q</span>(ss[<span class="number">7</span>:<span class="number">4</span>]));</span><br><span class="line">    bcd_counter bcd_counter_inst_2(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.ena</span>(ena &amp; (ss[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span>) &amp; (ss[<span class="number">7</span>:<span class="number">4</span>] == <span class="number">4&#x27;d5</span>)),<span class="variable">.q</span>(mm[<span class="number">3</span>:<span class="number">0</span>]));</span><br><span class="line">    bcd_counter_mod_6 bcd_counter_mod_6_inst_2(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.ena</span>(ena &amp; (ss[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span>) &amp; (ss[<span class="number">7</span>:<span class="number">4</span>] == <span class="number">4&#x27;d5</span>) &amp; (mm[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span>)),<span class="variable">.q</span>(mm[<span class="number">7</span>:<span class="number">4</span>]));</span><br><span class="line">    bcd_counter_mod_12 bcd_counter_inst_3(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.ena</span>(ena &amp; (ss[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span>) &amp; (ss[<span class="number">7</span>:<span class="number">4</span>] == <span class="number">4&#x27;d5</span>) &amp; (mm[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span>) &amp; (mm[<span class="number">7</span>:<span class="number">4</span>] == <span class="number">4&#x27;d5</span>)),<span class="variable">.q</span>(hh[<span class="number">7</span>:<span class="number">0</span>]));</span><br><span class="line">    bcd_counter_pm bcd_counter_pm_inst_1(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.ena</span>(ena &amp; (ss[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span>) &amp; (ss[<span class="number">7</span>:<span class="number">4</span>] == <span class="number">4&#x27;d5</span>) &amp; (mm[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d9</span>) &amp; (mm[<span class="number">7</span>:<span class="number">4</span>] == <span class="number">4&#x27;d5</span>) &amp; (hh[<span class="number">7</span>:<span class="number">0</span>] == <span class="number">8&#x27;h11</span>)),<span class="variable">.q</span>(pm));<span class="comment">// 这里以前有个bug：hh[7:0] == 4&#x27;h11；位宽没对上</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> bcd_counter(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] q</span><br><span class="line">);</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (reset) <span class="keyword">begin</span></span><br><span class="line">        q &lt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (ena == <span class="number">1&#x27;b1</span>) <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> (q == <span class="number">4&#x27;d9</span>) <span class="keyword">begin</span></span><br><span class="line">                q &lt;= <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                q &lt;= q + <span class="number">1&#x27;b1</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            q &lt;= q;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> bcd_counter_mod_6(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] q</span><br><span class="line">);</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (reset) <span class="keyword">begin</span></span><br><span class="line">        q &lt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (ena == <span class="number">1&#x27;b1</span>) <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> (q == <span class="number">4&#x27;d5</span>) <span class="keyword">begin</span></span><br><span class="line">                q &lt;= <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                q &lt;= q + <span class="number">1&#x27;b1</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            q &lt;= q;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> bcd_counter_mod_12(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] q</span><br><span class="line">);</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (reset) <span class="keyword">begin</span></span><br><span class="line">        q &lt;= <span class="number">8&#x27;h12</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (ena == <span class="number">1&#x27;b1</span>) <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> (q == <span class="number">8&#x27;h12</span>) <span class="keyword">begin</span></span><br><span class="line">                q &lt;= <span class="number">8&#x27;h01</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (q == <span class="number">8&#x27;h09</span>) <span class="keyword">begin</span></span><br><span class="line">                q &lt;= <span class="number">8&#x27;h10</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                q &lt;= q + <span class="number">1&#x27;b1</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            q &lt;= q;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> bcd_counter_pm(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> q</span><br><span class="line">);</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (reset) <span class="keyword">begin</span></span><br><span class="line">        q &lt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (ena == <span class="number">1&#x27;b1</span>) <span class="keyword">begin</span></span><br><span class="line">           q &lt;= ~q; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            q &lt;= q;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<h3 id="debug-1">Debug</h3>
<ul>
<li>例化模块时，需要在信号前面加上<code>.</code>，否则出现报错<code>cannot connect instance ports both by order and by name</code>。</li>
<li>定义模块是，结尾加<strong>分号</strong>。</li>
<li><code>truncated literal to match 4 bits File</code>；数值的位宽没有对上</li>
</ul>
<h3 id="summary">Summary</h3>
<p>这道题卡了很久，也算是最后独立完成了，主要要注意的点就是：</p>
<ul>
<li>位宽对上，细节问题，也是最后一个bug</li>
<li>模块复用的意识要到位</li>
<li>中间遇到的主要的问题是模12的BCD计数器的设计，这个暂时是这样写了，不知道有没有更好的办法</li>
<li>前面的思路是错误的，忘记了他是bcd计数。</li>
</ul>
<p>关于BCD计数的问题，网上看了一下，应该大多数都是这样做的，分成不同的位，进行计数。对于不是模10的倍数的BCD计数器，我这里是进行了单独的设计，网上的也是这样，只不过其是单独设计了模60和模12的计数器，我这里是设计的了模10、模6、模12的计数器。可以后面再看有没有更好的方式罢了。</p>
<h2 id="reference">Reference</h2>
<ol type="1">
<li><a target="_blank" rel="noopener" href="https://hdlbits.01xz.net/wiki/Main_Page">HDLBits
(01xz.net)</a></li>
<li><a target="_blank" rel="noopener" href="https://bbs.huaweicloud.com/blogs/detail/283302">HDLBits
系列（16）Something about Counter-云社区-华为云
(huaweicloud.com)</a></li>
</ol>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/verilog/" rel="tag"># verilog</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/03/22/%E3%80%90CNC3018%E3%80%91-00-GetStarted/" rel="prev" title="【CNC3018】-00-GetStarted">
                  <i class="fa fa-chevron-left"></i> 【CNC3018】-00-GetStarted
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/03/24/%E3%80%90%E5%A4%A7%E5%88%9B%E3%80%91-00-BH1750/" rel="next" title="【大创】-00-BH1750">
                  【大创】-00-BH1750 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">PengXuanyao</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  





  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
